<?xml version="1.0"?>
<?xml-stylesheet href="chrome://global/skin/" type="text/css"?>
<?xml-stylesheet href="chrome://zotero-platform/content/preferences.css"?>

<!--
  Unified Preferences pane for Zotero 7/8
  This document must contain a single <prefpane> root element for Zotero.PreferencePanes.
  It reuses the same ids and preference names as options.xhtml, so existing logic in options.js applies.
-->
<prefpane id="zotodo-prefpane" xmlns="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul" onload="try { var o=null; if (typeof Zotero !== 'undefined') { if (Zotero) { if (Zotero.Zotodo) { if (Zotero.Zotodo.Options) { o=Zotero.Zotodo.Options; } } } } if (o) { if (o.updatePreferenceWindow) { o.updatePreferenceWindow('init-all'); } } } catch (e) {}">
  <preferences>
    <preference id="pref-zotodo-automatic-add" name="extensions.zotodo.automatic_add" type="bool"/>
    <preference id="pref-zotodo-ignore-collections" name="extensions.zotodo.ignore_collections" type="string"/>
    <preference id="pref-zotodo-include-note" name="extensions.zotodo.include_note" type="bool"/>
    <preference id="pref-zotodo-note-format" name="extensions.zotodo.note_format" type="string"/>
    <preference id="pref-zotodo-due-string" name="extensions.zotodo.due_string" type="string"/>
    <preference id="pref-zotodo-priority" name="extensions.zotodo.priority" type="int"/>
    <preference id="pref-zotodo-project" name="extensions.zotodo.project" type="string"/>
    <preference id="pref-zotodo-section" name="extensions.zotodo.section" type="string"/>
    <preference id="pref-zotodo-set-due" name="extensions.zotodo.set_due" type="bool"/>
    <preference id="pref-zotodo-labels" name="extensions.zotodo.labels" type="string"/>
    <preference id="pref-zotodo-task-format" name="extensions.zotodo.task_format" type="string"/>
    <preference id="pref-zotodo-todoist-token" name="extensions.zotodo.todoist_token" type="string"/>
  </preferences>

  <groupbox>
    <caption label="Todoist settings"/>
    <separator/>

    <label id="id-zotodo-todoist-token-label" value="Todoist API token" control="id-zotodo-todoist-token"/>
    <textbox id="id-zotodo-todoist-token" preference="pref-zotodo-todoist-token" flex="1"/>
    <separator/>

    <label id="id-zotodo-project-label" value="Project" control="id-zotodo-project"/>
    <textbox id="id-zotodo-project" preference="pref-zotodo-project" flex="1"/>
    <separator/>

    <label id="id-zotodo-section-label" value="Section (optional)" control="id-zotodo-section"/>
    <textbox id="id-zotodo-section" preference="pref-zotodo-section" flex="1"/>
    <separator/>

    <checkbox id="id-zotodo-set-due" preference="pref-zotodo-set-due" label="Set due date" oncommand="try { if (Zotero) { if (Zotero.Zotodo) { if (Zotero.Zotodo.Options) { Zotero.Zotodo.Options.updatePreferenceWindow('set-due'); } } } } catch(e) {}"/>
    <separator/>

    <label id="id-zotodo-due-string-label" value="Due date (natural language)" control="id-zotodo-due-string"/>
    <textbox id="id-zotodo-due-string" preference="pref-zotodo-due-string" flex="1"/>
    <separator/>

    <label id="id-zotodo-labels-label" value="Labels (comma-separated)" control="id-zotodo-labels"/>
    <textbox id="id-zotodo-labels" preference="pref-zotodo-labels" flex="1"/>
    <separator/>

    <label id="id-zotodo-priority-label" value="Priority (1..4, 1 = low, 4 = high)" control="id-zotodo-priority"/>
    <textbox id="id-zotodo-priority" min="1" max="4" type="number" preference="pref-zotodo-priority" flex="1"/>
    <separator/>
  </groupbox>

  <separator/>

  <groupbox>
    <caption label="Zotodo settings"/>
    <separator/>

    <label id="id-zotodo-task-format-label" value="Task format" control="id-zotodo-task-format"/>
    <textbox id="id-zotodo-task-format" preference="pref-zotodo-task-format" flex="1"/>
    <label id="id-zotodo-task-format-wildcards" style="font-size: 10px" value="Tokens: ${title}, ${authors}, ${et_al}, ${doi}, ${url}, ${select_uri}, ${open_uri}, ${citekey}"/>
    <separator/>

    <checkbox id="id-zotodo-include-note" preference="pref-zotodo-include-note" label="Include note" oncommand="try { if (Zotero) { if (Zotero.Zotodo) { if (Zotero.Zotodo.Options) { Zotero.Zotodo.Options.updatePreferenceWindow('include-note'); } } } } catch(e) {}"/>
    <separator/>

    <label id="id-zotodo-note-format" value="Note format" control="id-zotodo-note-format"/>
    <textbox id="id-zotodo-note-format" preference="pref-zotodo-note-format" flex="1"/>
    <label id="id-zotodo-note-format-wildcards" style="font-size: 10px" value="Tokens: ${title}, ${abstract}, ${url}, ${doi}, ${pdf_path}, ${citekey}"/>
    <separator/>

    <checkbox id="id-zotodo-automatic-add" preference="pref-zotodo-automatic-add" label="Automatically add tasks for new items"/>
    <separator/>

    <label id="id-zotodo-ignore-collections-label" value="Ignore collections (comma-separated names)" control="id-zotodo-ignore-collections"/>
    <textbox id="id-zotodo-ignore-collections" preference="pref-zotodo-ignore-collections" flex="1"/>
  </groupbox>

  <!-- Load behavior for enabling/disabling fields based on prefs -->
  <script src="chrome://zotodo/content/options.js"/>
</prefpane>
